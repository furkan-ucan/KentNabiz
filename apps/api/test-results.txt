
> api@0.0.1 test:e2e C:\Users\furka\KentNabiz\apps\api
> jest --config ./test/jest-e2e.json

[31m[Nest] 21412  - [39m25.05.2025 12:26:02 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 403 Final Response Payload: {"statusCode":403,"message":"Insufficient permissions.","error":"ForbiddenException","timestamp":"2025-05-25T09:26:02.388Z","path":"/users/5/active-team"} Path: /users/5/active-team Method: PATCH[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:02 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mForbiddenException: Insufficient permissions.
    at RolesGuard.canActivate (C:\Users\furka\KentNabiz\apps\api\src\modules\auth\guards\roles.guard.ts:41:13)
    at GuardsConsumer.tryActivate (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\guards\guards-consumer.js:15:34)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at canActivateFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:135:33)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:42:31
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-proxy.js:9:17[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:02 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 400 Final Response Payload: {"statusCode":400,"message":"Team leader must be from the same department as the team.","error":"BadRequestException","timestamp":"2025-05-25T09:26:02.418Z","path":"/teams"} Path: /teams Method: POST[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:02 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mBadRequestException: Team leader must be from the same department as the team.
    at TeamsService.create (C:\Users\furka\KentNabiz\apps\api\src\modules\teams\services\teams.service.ts:94:15)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:02 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 400 Final Response Payload: {"statusCode":400,"message":"User must be from the same department as the team.","error":"BadRequestException","timestamp":"2025-05-25T09:26:02.564Z","path":"/users/6/active-team"} Path: /users/6/active-team Method: PATCH[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:02 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mBadRequestException: User must be from the same department as the team.
    at UsersService.updateUserActiveTeam (C:\Users\furka\KentNabiz\apps\api\src\modules\users\services\users.service.ts:300:15)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at UsersController.updateActiveTeam (C:\Users\furka\KentNabiz\apps\api\src\modules\users\controllers\users.controller.ts:183:25)[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:02 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 404 Final Response Payload: {"statusCode":404,"message":"Team with ID 999999 not found","error":"NotFoundException","timestamp":"2025-05-25T09:26:02.591Z","path":"/users/5/active-team"} Path: /users/5/active-team Method: PATCH[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:02 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mNotFoundException: Team with ID 999999 not found
    at UsersService.updateUserActiveTeam (C:\Users\furka\KentNabiz\apps\api\src\modules\users\services\users.service.ts:283:15)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at UsersController.updateActiveTeam (C:\Users\furka\KentNabiz\apps\api\src\modules\users\controllers\users.controller.ts:183:25)[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:02 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 404 Final Response Payload: {"statusCode":404,"message":"User with ID 999999 not found","error":"NotFoundException","timestamp":"2025-05-25T09:26:02.614Z","path":"/users/999999/active-team"} Path: /users/999999/active-team Method: PATCH[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:02 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mNotFoundException: User with ID 999999 not found
    at UsersService.updateUserActiveTeam (C:\Users\furka\KentNabiz\apps\api\src\modules\users\services\users.service.ts:268:13)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at UsersController.updateActiveTeam (C:\Users\furka\KentNabiz\apps\api\src\modules\users\controllers\users.controller.ts:183:25)[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:02 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 401 Final Response Payload: {"statusCode":401,"message":"Unauthorized","error":"UnauthorizedException","timestamp":"2025-05-25T09:26:02.629Z","path":"/users/5/active-team"} Path: /users/5/active-team Method: PATCH[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:02 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mUnauthorizedException: Unauthorized
    at JwtAuthGuard.handleRequest (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:60:30)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:44:124
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:83:24
    at allFailed (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport@0.7.0\node_modules\passport\lib\middleware\authenticate.js:110:18)
    at attempt (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport@0.7.0\node_modules\passport\lib\middleware\authenticate.js:183:28)
    at JwtStrategy.strategy.fail (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport@0.7.0\node_modules\passport\lib\middleware\authenticate.js:314:9)
    at JwtStrategy.Object.<anonymous>.JwtStrategy.authenticate (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport-jwt@4.0.1\node_modules\passport-jwt\lib\strategy.js:96:21)
    at attempt (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport@0.7.0\node_modules\passport\lib\middleware\authenticate.js:378:16)
    at authenticate (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport@0.7.0\node_modules\passport\lib\middleware\authenticate.js:379:7)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:88:3
    at new Promise (<anonymous>)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:80:83
    at JwtAuthGuard.canActivate (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:44:32)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
HttpExceptionFilter
PASS test/users-team-assignment.e2e-spec.ts (11.387 s)
  ‚óè Console

    console.log
      üß™ Setting up E2E test environment...

      at Object.<anonymous> (test/setup-e2e.ts:13:11)

    console.log
      ‚úÖ Test data seeded successfully

      at seedTestData (test/setup-e2e.ts:165:11)

    console.log
      üßπ E2E test environment cleaned up

      at Object.<anonymous> (test/setup-e2e.ts:25:11)

[31m[Nest] 21412  - [39m25.05.2025 12:26:07 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 403 Final Response Payload: {"statusCode":403,"message":"Insufficient permissions.","error":"ForbiddenException","timestamp":"2025-05-25T09:26:07.242Z","path":"/teams"} Path: /teams Method: POST[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:07 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mForbiddenException: Insufficient permissions.
    at RolesGuard.canActivate (C:\Users\furka\KentNabiz\apps\api\src\modules\auth\guards\roles.guard.ts:41:13)
    at GuardsConsumer.tryActivate (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\guards\guards-consumer.js:15:34)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at canActivateFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:135:33)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:42:31
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-proxy.js:9:17[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:07 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 403 Final Response Payload: {"statusCode":403,"message":"Insufficient permissions.","error":"ForbiddenException","timestamp":"2025-05-25T09:26:07.273Z","path":"/teams/4/members/3"} Path: /teams/4/members/3 Method: POST[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:07 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mForbiddenException: Insufficient permissions.
    at RolesGuard.canActivate (C:\Users\furka\KentNabiz\apps\api\src\modules\auth\guards\roles.guard.ts:41:13)
    at GuardsConsumer.tryActivate (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\guards\guards-consumer.js:15:34)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at canActivateFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:135:33)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:42:31
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-proxy.js:9:17[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:07 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 401 Final Response Payload: {"statusCode":401,"message":"Unauthorized","error":"UnauthorizedException","timestamp":"2025-05-25T09:26:07.347Z","path":"/teams/4"} Path: /teams/4 Method: GET[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:07 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mUnauthorizedException: Unauthorized
    at JwtAuthGuard.handleRequest (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:60:30)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:44:124
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:83:24
    at allFailed (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport@0.7.0\node_modules\passport\lib\middleware\authenticate.js:110:18)
    at attempt (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport@0.7.0\node_modules\passport\lib\middleware\authenticate.js:183:28)
    at JwtStrategy.strategy.fail (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport@0.7.0\node_modules\passport\lib\middleware\authenticate.js:314:9)
    at JwtStrategy.Object.<anonymous>.JwtStrategy.authenticate (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport-jwt@4.0.1\node_modules\passport-jwt\lib\strategy.js:96:21)
    at attempt (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport@0.7.0\node_modules\passport\lib\middleware\authenticate.js:378:16)
    at authenticate (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport@0.7.0\node_modules\passport\lib\middleware\authenticate.js:379:7)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:88:3
    at new Promise (<anonymous>)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:80:83
    at JwtAuthGuard.canActivate (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:44:32)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:07 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 400 Final Response Payload: {"statusCode":400,"message":"name should not be empty; departmentId must be an integer number; teamLeaderId must be an integer number; Invalid value","error":"BadRequestException","timestamp":"2025-05-25T09:26:07.384Z","path":"/teams"} Path: /teams Method: POST[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:07 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mBadRequestException: Validation failed
    at ValidationPipe.transform (C:\Users\furka\KentNabiz\apps\api\src\core\pipes\validation.pipe.ts:19:13)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\pipes\pipes-consumer.js:15:25
    at resolveParamValue (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:148:23)
    at async Promise.all (index 1)
    at pipesFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:151:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:37:30[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:07 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 400 Final Response Payload: {"statusCode":400,"message":"status must be one of the following values: AVAILABLE, ON_DUTY, OFF_DUTY, INACTIVE","error":"BadRequestException","timestamp":"2025-05-25T09:26:07.416Z","path":"/teams/4"} Path: /teams/4 Method: PATCH[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:07 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mBadRequestException: Validation failed
    at ValidationPipe.transform (C:\Users\furka\KentNabiz\apps\api\src\core\pipes\validation.pipe.ts:19:13)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\pipes\pipes-consumer.js:15:25
    at resolveParamValue (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:148:23)
    at async Promise.all (index 1)
    at pipesFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:151:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:37:30[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:07 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 404 Final Response Payload: {"statusCode":404,"message":"User with ID 99999 not found.","error":"NotFoundException","timestamp":"2025-05-25T09:26:07.457Z","path":"/teams/4/members/99999"} Path: /teams/4/members/99999 Method: POST[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:07 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mNotFoundException: User with ID 99999 not found.
    at TeamsService.addMemberToTeam (C:\Users\furka\KentNabiz\apps\api\src\modules\teams\services\teams.service.ts:248:13)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:07 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 404 Final Response Payload: {"statusCode":404,"message":"Specialization with ID 99999 not found.","error":"NotFoundException","timestamp":"2025-05-25T09:26:07.514Z","path":"/teams/4/specializations/99999"} Path: /teams/4/specializations/99999 Method: POST[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:07 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mNotFoundException: Specialization with ID 99999 not found.
    at TeamsService.addSpecializationToTeam (C:\Users\furka\KentNabiz\apps\api\src\modules\teams\services\teams.service.ts:340:13)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:07 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 400 Final Response Payload: {"statusCode":400,"message":"lat must not be greater than 90, lat must not be less than -90, lat must be a number conforming to the specified constraints","error":"BadRequestException","timestamp":"2025-05-25T09:26:07.532Z","path":"/teams/nearby?lat=invalid&lng=29.0"} Path: /teams/nearby?lat=invalid&lng=29.0 Method: GET[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:07 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mBadRequestException: Validation failed
    at ValidationPipe.transform (C:\Users\furka\KentNabiz\apps\api\src\core\pipes\validation.pipe.ts:19:13)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\pipes\pipes-consumer.js:15:25
    at resolveParamValue (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:148:23)
    at async Promise.all (index 0)
    at pipesFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:151:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:37:30[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:07 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 404 Final Response Payload: {"statusCode":404,"message":"Team with ID 99999 not found.","error":"NotFoundException","timestamp":"2025-05-25T09:26:07.637Z","path":"/teams/99999"} Path: /teams/99999 Method: DELETE[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:07 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mNotFoundException: Team with ID 99999 not found.
    at TeamsService.findOne (C:\Users\furka\KentNabiz\apps\api\src\modules\teams\services\teams.service.ts:166:13)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at TeamsService.remove (C:\Users\furka\KentNabiz\apps\api\src\modules\teams\services\teams.service.ts:216:18)[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:07 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 400 Final Response Payload: {"statusCode":400,"message":"Validation failed (numeric string is expected)","error":"BadRequestException","timestamp":"2025-05-25T09:26:07.675Z","path":"/teams/not-a-number"} Path: /teams/not-a-number Method: GET[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:07 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mBadRequestException: Validation failed (numeric string is expected)
    at ParseIntPipe.exceptionFactory (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:24:27)
    at ParseIntPipe.transform (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:38:24)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\pipes\pipes-consumer.js:16:33
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at resolveParamValue (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:148:23)
    at async Promise.all (index 1)
    at pipesFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:151:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:37:30[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:07 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 400 Final Response Payload: {"statusCode":400,"message":"Validation failed (numeric string is expected)","error":"BadRequestException","timestamp":"2025-05-25T09:26:07.862Z","path":"/teams/undefined/members/3"} Path: /teams/undefined/members/3 Method: POST[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:07 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mBadRequestException: Validation failed (numeric string is expected)
    at ParseIntPipe.exceptionFactory (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:24:27)
    at ParseIntPipe.transform (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:38:24)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\pipes\pipes-consumer.js:16:33
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at resolveParamValue (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:148:23)
    at async Promise.all (index 2)
    at pipesFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:151:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:37:30[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:07 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 400 Final Response Payload: {"statusCode":400,"message":"Validation failed (numeric string is expected)","error":"BadRequestException","timestamp":"2025-05-25T09:26:07.871Z","path":"/teams/undefined/members/3"} Path: /teams/undefined/members/3 Method: POST[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:07 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mBadRequestException: Validation failed (numeric string is expected)
    at ParseIntPipe.exceptionFactory (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:24:27)
    at ParseIntPipe.transform (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:38:24)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\pipes\pipes-consumer.js:16:33
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at resolveParamValue (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:148:23)
    at async Promise.all (index 2)
    at pipesFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:151:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:37:30[39m
HttpExceptionFilter
FAIL test/team-management.e2e-spec.ts (5.192 s)
  ‚óè Console

    console.log
      üß™ Setting up E2E test environment...

      at Object.<anonymous> (test/setup-e2e.ts:13:11)

    console.log
      ‚úÖ Test data seeded successfully

      at seedTestData (test/setup-e2e.ts:165:11)

    console.log
      üßπ E2E test environment cleaned up

      at Object.<anonymous> (test/setup-e2e.ts:25:11)

  ‚óè Team Management E2E ‚Ä∫ Team Member Management ‚Ä∫ 1. Should add member to team (DEPARTMENT_SUPERVISOR)

    expected 200 "OK", got 201 "Created"

    [0m [90m 166 |[39m         [33m.[39mpost([32m`/teams/${createdTeamId}/members/${testUserId}`[39m)
     [90m 167 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${authHelper.getSupervisorToken()}`[39m)
    [31m[1m>[22m[39m[90m 168 |[39m         [33m.[39mexpect([35m200[39m)[33m;[39m
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 169 |[39m
     [90m 170 |[39m       [90m// The response should be the updated team or confirmation[39m
     [90m 171 |[39m       expect(response[33m.[39mbody[33m.[39mdata)[33m.[39mtoBeDefined()[33m;[39m[0m

      at Object.<anonymous> (test/team-management.e2e-spec.ts:168:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Team Management E2E ‚Ä∫ Team Specialization Management ‚Ä∫ 1. Should add specialization to team (DEPARTMENT_SUPERVISOR)

    expected 200 "OK", got 201 "Created"

    [0m [90m 219 |[39m         [33m.[39mpost([32m`/teams/${createdTeamId}/specializations/${testSpecializationId}`[39m)
     [90m 220 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${authHelper.getSupervisorToken()}`[39m)
    [31m[1m>[22m[39m[90m 221 |[39m         [33m.[39mexpect([35m200[39m)[33m;[39m
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 222 |[39m
     [90m 223 |[39m       expect(response[33m.[39mbody[33m.[39mdata)[33m.[39mtoBeDefined()[33m;[39m
     [90m 224 |[39m     })[33m;[39m[0m

      at Object.<anonymous> (test/team-management.e2e-spec.ts:221:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Team Management E2E ‚Ä∫ Authorization Tests ‚Ä∫ Should allow SYSTEM_ADMIN to access any team

    expect(received).toMatchObject(expected)

    - Expected  - 2
    + Received  + 2

      Object {
        "departmentId": 1,
        "id": 4,
    -   "name": "Emergency Response Team Alpha",
    -   "status": "AVAILABLE",
    +   "name": "Emergency Response Team Alpha - Updated",
    +   "status": "ON_DUTY",
      }

    [0m [90m 315 |[39m         [33m.[39mexpect([35m200[39m)[33m;[39m
     [90m 316 |[39m
    [31m[1m>[22m[39m[90m 317 |[39m       expect(response[33m.[39mbody[33m.[39mdata)[33m.[39mtoMatchObject({
     [90m     |[39m                                  [31m[1m^[22m[39m
     [90m 318 |[39m         id[33m:[39m createdTeamId[33m,[39m
     [90m 319 |[39m         name[33m:[39m [32m'Emergency Response Team Alpha'[39m[33m,[39m
     [90m 320 |[39m         departmentId[33m:[39m testDepartmentId[33m,[39m[0m

      at Object.<anonymous> (test/team-management.e2e-spec.ts:317:34)

  ‚óè Team Management E2E ‚Ä∫ Team Deletion ‚Ä∫ Should delete team (DEPARTMENT_SUPERVISOR)

    expected 404 "Not Found", got 200 "OK"

    [0m [90m 396 |[39m         [33m.[39m[36mget[39m([32m`/teams/${createdTeamId}`[39m)
     [90m 397 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${authHelper.getSupervisorToken()}`[39m)
    [31m[1m>[22m[39m[90m 398 |[39m         [33m.[39mexpect([35m404[39m)[33m;[39m
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 399 |[39m     })[33m;[39m
     [90m 400 |[39m
     [90m 401 |[39m     it([32m'Should handle deletion of non-existent team gracefully'[39m[33m,[39m [36masync[39m () [33m=>[39m {[0m

      at Object.<anonymous> (test/team-management.e2e-spec.ts:398:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Team Management E2E ‚Ä∫ Edge Cases and Error Handling ‚Ä∫ Should handle concurrent team member additions gracefully

    expect(received).toContain(expected) // indexOf

    Expected value: 200
    Received array: [400, 400]

    [0m [90m 454 |[39m       )[33m;[39m
     [90m 455 |[39m
    [31m[1m>[22m[39m[90m 456 |[39m       expect(responses)[33m.[39mtoContain([35m200[39m)[33m;[39m [90m// At least one success[39m
     [90m     |[39m                         [31m[1m^[22m[39m
     [90m 457 |[39m
     [90m 458 |[39m       [90m// Clean up[39m
     [90m 459 |[39m       [36mawait[39m request(app[33m.[39mgetHttpServer())[0m

      at Object.<anonymous> (test/team-management.e2e-spec.ts:456:25)

[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 500 Final Response Payload: {"statusCode":500,"message":"Internal server error","error":"TransactionNotStartedError","timestamp":"2025-05-25T09:26:11.250Z","path":"/reports"} Path: /reports Method: POST[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mTransactionNotStartedError: Transaction is not started yet, start transaction before committing or rolling it back.
    at PostgresQueryRunner.rollbackTransaction (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\driver\postgres\PostgresQueryRunner.ts:220:46)
    at ReportRepository.create (C:\Users\furka\KentNabiz\apps\api\src\modules\reports\repositories\report.repository.ts:228:25)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at ReportsService.create (C:\Users\furka\KentNabiz\apps\api\src\modules\reports\services\reports.service.ts:258:29)[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 400 Final Response Payload: {"statusCode":400,"message":"Validation failed (numeric string is expected)","error":"BadRequestException","timestamp":"2025-05-25T09:26:11.368Z","path":"/reports/undefined"} Path: /reports/undefined Method: GET[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mBadRequestException: Validation failed (numeric string is expected)
    at ParseIntPipe.exceptionFactory (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:24:27)
    at ParseIntPipe.transform (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:38:24)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\pipes\pipes-consumer.js:16:33
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at resolveParamValue (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:148:23)
    at async Promise.all (index 1)
    at pipesFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:151:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:37:30[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 400 Final Response Payload: {"statusCode":400,"message":"Validation failed (numeric string is expected)","error":"BadRequestException","timestamp":"2025-05-25T09:26:11.398Z","path":"/reports/undefined/status"} Path: /reports/undefined/status Method: PATCH[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mBadRequestException: Validation failed (numeric string is expected)
    at ParseIntPipe.exceptionFactory (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:24:27)
    at ParseIntPipe.transform (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:38:24)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\pipes\pipes-consumer.js:16:33
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at resolveParamValue (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:148:23)
    at async Promise.all (index 2)
    at pipesFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:151:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:37:30[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 400 Final Response Payload: {"statusCode":400,"message":"Validation failed (numeric string is expected)","error":"BadRequestException","timestamp":"2025-05-25T09:26:11.417Z","path":"/reports/undefined/assign-team/1"} Path: /reports/undefined/assign-team/1 Method: PATCH[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mBadRequestException: Validation failed (numeric string is expected)
    at ParseIntPipe.exceptionFactory (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:24:27)
    at ParseIntPipe.transform (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:38:24)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\pipes\pipes-consumer.js:16:33
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at resolveParamValue (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:148:23)
    at async Promise.all (index 2)
    at pipesFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:151:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:37:30[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 400 Final Response Payload: {"statusCode":400,"message":"Validation failed (numeric string is expected)","error":"BadRequestException","timestamp":"2025-05-25T09:26:11.441Z","path":"/reports/undefined/status"} Path: /reports/undefined/status Method: PATCH[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mBadRequestException: Validation failed (numeric string is expected)
    at ParseIntPipe.exceptionFactory (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:24:27)
    at ParseIntPipe.transform (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:38:24)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\pipes\pipes-consumer.js:16:33
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at resolveParamValue (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:148:23)
    at async Promise.all (index 2)
    at pipesFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:151:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:37:30[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 400 Final Response Payload: {"statusCode":400,"message":"Validation failed (numeric string is expected)","error":"BadRequestException","timestamp":"2025-05-25T09:26:11.472Z","path":"/reports/undefined/status"} Path: /reports/undefined/status Method: PATCH[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mBadRequestException: Validation failed (numeric string is expected)
    at ParseIntPipe.exceptionFactory (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:24:27)
    at ParseIntPipe.transform (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:38:24)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\pipes\pipes-consumer.js:16:33
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at resolveParamValue (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:148:23)
    at async Promise.all (index 2)
    at pipesFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:151:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:37:30[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 400 Final Response Payload: {"statusCode":400,"message":"Validation failed (numeric string is expected)","error":"BadRequestException","timestamp":"2025-05-25T09:26:11.489Z","path":"/reports/undefined/status"} Path: /reports/undefined/status Method: PATCH[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mBadRequestException: Validation failed (numeric string is expected)
    at ParseIntPipe.exceptionFactory (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:24:27)
    at ParseIntPipe.transform (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:38:24)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\pipes\pipes-consumer.js:16:33
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at resolveParamValue (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:148:23)
    at async Promise.all (index 2)
    at pipesFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:151:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:37:30[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 400 Final Response Payload: {"statusCode":400,"message":"Validation failed (numeric string is expected)","error":"BadRequestException","timestamp":"2025-05-25T09:26:11.505Z","path":"/reports/undefined/status-history"} Path: /reports/undefined/status-history Method: GET[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mBadRequestException: Validation failed (numeric string is expected)
    at ParseIntPipe.exceptionFactory (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:24:27)
    at ParseIntPipe.transform (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:38:24)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\pipes\pipes-consumer.js:16:33
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at resolveParamValue (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:148:23)
    at async Promise.all (index 1)
    at pipesFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:151:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:37:30[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 403 Final Response Payload: {"statusCode":403,"message":"Insufficient permissions.","error":"ForbiddenException","timestamp":"2025-05-25T09:26:11.518Z","path":"/reports/undefined/assign-team/1"} Path: /reports/undefined/assign-team/1 Method: PATCH[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mForbiddenException: Insufficient permissions.
    at RolesGuard.canActivate (C:\Users\furka\KentNabiz\apps\api\src\modules\auth\guards\roles.guard.ts:41:13)
    at GuardsConsumer.tryActivate (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\guards\guards-consumer.js:15:34)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at canActivateFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:135:33)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:42:31
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-proxy.js:9:17[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 403 Final Response Payload: {"statusCode":403,"message":"Insufficient permissions.","error":"ForbiddenException","timestamp":"2025-05-25T09:26:11.542Z","path":"/reports/undefined/status"} Path: /reports/undefined/status Method: PATCH[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mForbiddenException: Insufficient permissions.
    at RolesGuard.canActivate (C:\Users\furka\KentNabiz\apps\api\src\modules\auth\guards\roles.guard.ts:41:13)
    at GuardsConsumer.tryActivate (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\guards\guards-consumer.js:15:34)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at canActivateFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:135:33)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:42:31
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-proxy.js:9:17[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 401 Final Response Payload: {"statusCode":401,"message":"Unauthorized","error":"UnauthorizedException","timestamp":"2025-05-25T09:26:11.561Z","path":"/reports/undefined"} Path: /reports/undefined Method: GET[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mUnauthorizedException: Unauthorized
    at JwtAuthGuard.handleRequest (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:60:30)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:44:124
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:83:24
    at allFailed (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport@0.7.0\node_modules\passport\lib\middleware\authenticate.js:110:18)
    at attempt (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport@0.7.0\node_modules\passport\lib\middleware\authenticate.js:183:28)
    at JwtStrategy.strategy.fail (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport@0.7.0\node_modules\passport\lib\middleware\authenticate.js:314:9)
    at JwtStrategy.Object.<anonymous>.JwtStrategy.authenticate (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport-jwt@4.0.1\node_modules\passport-jwt\lib\strategy.js:96:21)
    at attempt (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport@0.7.0\node_modules\passport\lib\middleware\authenticate.js:378:16)
    at authenticate (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport@0.7.0\node_modules\passport\lib\middleware\authenticate.js:379:7)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:88:3
    at new Promise (<anonymous>)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:80:83
    at JwtAuthGuard.canActivate (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:44:32)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 400 Final Response Payload: {"statusCode":400,"message":"title should not be empty; Invalid value; reportType must be one of the following values: POTHOLE, ROAD_DAMAGE, ROAD_SIGN, ROAD_MARKING, ROAD_CONSTRUCTION, ROAD_MAINTENANCE, ROAD_CLEANING, ROAD_REPAIR, ROAD_BLOCK, TRAFFIC_LIGHT, STREET_LIGHT, ELECTRICITY_OUTAGE, WATER_LEAKAGE, LITTER, GRAFFITI, PARK_DAMAGE, TREE_ISSUE, PARKING_VIOLATION, PUBLIC_TRANSPORT, PUBLIC_TRANSPORT_VIOLATION, PUBLIC_TRANSPORT_STOP, PUBLIC_TRANSPORT_VEHICLE, GARBAGE_COLLECTION, OTHER","error":"BadRequestException","timestamp":"2025-05-25T09:26:11.585Z","path":"/reports"} Path: /reports Method: POST[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mBadRequestException: Validation failed
    at ValidationPipe.transform (C:\Users\furka\KentNabiz\apps\api\src\core\pipes\validation.pipe.ts:19:13)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\pipes\pipes-consumer.js:15:25
    at resolveParamValue (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:148:23)
    at async Promise.all (index 1)
    at pipesFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:151:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:37:30[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 400 Final Response Payload: {"statusCode":400,"message":"newStatus must be one of the following values: OPEN, IN_REVIEW, IN_PROGRESS, DONE, REJECTED, CANCELLED","error":"BadRequestException","timestamp":"2025-05-25T09:26:11.606Z","path":"/reports/undefined/status"} Path: /reports/undefined/status Method: PATCH[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mBadRequestException: Validation failed
    at ValidationPipe.transform (C:\Users\furka\KentNabiz\apps\api\src\core\pipes\validation.pipe.ts:19:13)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\pipes\pipes-consumer.js:15:25
    at resolveParamValue (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:148:23)
    at async Promise.all (index 1)
    at pipesFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:151:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:37:30[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 400 Final Response Payload: {"statusCode":400,"message":"Validation failed (numeric string is expected)","error":"BadRequestException","timestamp":"2025-05-25T09:26:11.625Z","path":"/reports/undefined/assign-team/99999"} Path: /reports/undefined/assign-team/99999 Method: PATCH[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mBadRequestException: Validation failed (numeric string is expected)
    at ParseIntPipe.exceptionFactory (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:24:27)
    at ParseIntPipe.transform (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:38:24)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\pipes\pipes-consumer.js:16:33
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at resolveParamValue (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:148:23)
    at async Promise.all (index 2)
    at pipesFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:151:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:37:30[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 400 Final Response Payload: {"statusCode":400,"message":"Validation failed (numeric string is expected)","error":"BadRequestException","timestamp":"2025-05-25T09:26:11.649Z","path":"/reports/undefined/forward"} Path: /reports/undefined/forward Method: PATCH[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mBadRequestException: Validation failed (numeric string is expected)
    at ParseIntPipe.exceptionFactory (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:24:27)
    at ParseIntPipe.transform (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:38:24)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\pipes\pipes-consumer.js:16:33
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at resolveParamValue (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:148:23)
    at async Promise.all (index 2)
    at pipesFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:151:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:37:30[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 400 Final Response Payload: {"statusCode":400,"message":"Validation failed (numeric string is expected)","error":"BadRequestException","timestamp":"2025-05-25T09:26:11.665Z","path":"/reports/undefined/history"} Path: /reports/undefined/history Method: GET[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mBadRequestException: Validation failed (numeric string is expected)
    at ParseIntPipe.exceptionFactory (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:24:27)
    at ParseIntPipe.transform (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:38:24)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\pipes\pipes-consumer.js:16:33
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at resolveParamValue (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:148:23)
    at async Promise.all (index 1)
    at pipesFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:151:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:37:30[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 500 Final Response Payload: {"statusCode":500,"message":"Internal server error","error":"QueryFailedError","timestamp":"2025-05-25T09:26:11.695Z","path":"/reports?page=1&limit=10&status=DONE&reportType=POTHOLE"} Path: /reports?page=1&limit=10&status=DONE&reportType=POTHOLE Method: GET[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mQueryFailedError: column assignments.accepted_at does not exist
    at PostgresQueryRunner.query (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\driver\postgres\PostgresQueryRunner.ts:331:19)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at SelectQueryBuilder.loadRawResults (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\query-builder\SelectQueryBuilder.ts:3805:25)
    at SelectQueryBuilder.getRawMany (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\query-builder\SelectQueryBuilder.ts:1626:29)
    at SelectQueryBuilder.executeEntitiesAndRawResults (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\query-builder\SelectQueryBuilder.ts:3467:26)
    at SelectQueryBuilder.getManyAndCount (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\query-builder\SelectQueryBuilder.ts:1873:36)
    at ReportRepository.findAll (C:\Users\furka\KentNabiz\apps\api\src\modules\reports\repositories\report.repository.ts:80:30)[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 500 Final Response Payload: {"statusCode":500,"message":"Internal server error","error":"QueryFailedError","timestamp":"2025-05-25T09:26:11.771Z","path":"/reports/nearby?latitude=41.0&longitude=29.0&radius=1000"} Path: /reports/nearby?latitude=41.0&longitude=29.0&radius=1000 Method: GET[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mQueryFailedError: column assignments.accepted_at does not exist
    at PostgresQueryRunner.query (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\driver\postgres\PostgresQueryRunner.ts:331:19)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at SelectQueryBuilder.loadRawResults (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\query-builder\SelectQueryBuilder.ts:3805:25)
    at SelectQueryBuilder.getRawMany (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\query-builder\SelectQueryBuilder.ts:1626:29)
    at SelectQueryBuilder.executeEntitiesAndRawResults (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\query-builder\SelectQueryBuilder.ts:3467:26)
    at SelectQueryBuilder.getManyAndCount (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\query-builder\SelectQueryBuilder.ts:1873:36)
    at ReportRepository.findNearby (C:\Users\furka\KentNabiz\apps\api\src\modules\reports\repositories\report.repository.ts:168:30)[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 500 Final Response Payload: {"statusCode":500,"message":"Internal server error","error":"QueryFailedError","timestamp":"2025-05-25T09:26:11.804Z","path":"/reports/my-reports?page=1&limit=10"} Path: /reports/my-reports?page=1&limit=10 Method: GET[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:11 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mQueryFailedError: column assignments.accepted_at does not exist
    at PostgresQueryRunner.query (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\driver\postgres\PostgresQueryRunner.ts:331:19)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at SelectQueryBuilder.loadRawResults (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\query-builder\SelectQueryBuilder.ts:3805:25)
    at SelectQueryBuilder.getRawMany (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\query-builder\SelectQueryBuilder.ts:1626:29)
    at SelectQueryBuilder.executeEntitiesAndRawResults (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\query-builder\SelectQueryBuilder.ts:3467:26)
    at SelectQueryBuilder.getManyAndCount (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\query-builder\SelectQueryBuilder.ts:1873:36)
    at ReportRepository.findAll (C:\Users\furka\KentNabiz\apps\api\src\modules\reports\repositories\report.repository.ts:80:30)[39m
HttpExceptionFilter
FAIL test/report-lifecycle.e2e-spec.ts
  ‚óè Console

    console.log
      üß™ Setting up E2E test environment...

      at Object.<anonymous> (test/setup-e2e.ts:13:11)

    console.log
      ‚úÖ Test data seeded successfully

      at seedTestData (test/setup-e2e.ts:165:11)

    console.log
      üßπ E2E test environment cleaned up

      at Object.<anonymous> (test/setup-e2e.ts:25:11)

  ‚óè Report Lifecycle E2E ‚Ä∫ Complete Report Lifecycle ‚Ä∫ 1. Should create a new report (CITIZEN)

    expected 201 "Created", got 500 "Internal Server Error"

    [0m [90m 63 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${authHelper.getCitizenToken()}`[39m)
     [90m 64 |[39m         [33m.[39msend(createReportDto)
    [31m[1m>[22m[39m[90m 65 |[39m         [33m.[39mexpect([35m201[39m)[33m;[39m
     [90m    |[39m          [31m[1m^[22m[39m
     [90m 66 |[39m
     [90m 67 |[39m       expect(response[33m.[39mbody[33m.[39mdata)[33m.[39mtoMatchObject({
     [90m 68 |[39m         title[33m:[39m [32m'Large pothole on Main Street'[39m[33m,[39m[0m

      at Object.<anonymous> (test/report-lifecycle.e2e-spec.ts:65:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Report Lifecycle E2E ‚Ä∫ Complete Report Lifecycle ‚Ä∫ 2. Should get report by ID (CITIZEN can see own report)

    expected 200 "OK", got 400 "Bad Request"

    [0m [90m 83 |[39m         [33m.[39m[36mget[39m([32m`/reports/${createdReportId}`[39m)
     [90m 84 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${authHelper.getCitizenToken()}`[39m)
    [31m[1m>[22m[39m[90m 85 |[39m         [33m.[39mexpect([35m200[39m)[33m;[39m
     [90m    |[39m          [31m[1m^[22m[39m
     [90m 86 |[39m
     [90m 87 |[39m       expect(response[33m.[39mbody[33m.[39mdata)[33m.[39mtoMatchObject({
     [90m 88 |[39m         id[33m:[39m createdReportId[33m,[39m[0m

      at Object.<anonymous> (test/report-lifecycle.e2e-spec.ts:85:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Report Lifecycle E2E ‚Ä∫ Complete Report Lifecycle ‚Ä∫ 3. Should update report status to IN_REVIEW (DEPARTMENT_SUPERVISOR)

    expected 200 "OK", got 400 "Bad Request"

    [0m [90m 103 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${authHelper.getSupervisorToken()}`[39m)
     [90m 104 |[39m         [33m.[39msend(updateStatusDto)
    [31m[1m>[22m[39m[90m 105 |[39m         [33m.[39mexpect([35m200[39m)[33m;[39m
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 106 |[39m
     [90m 107 |[39m       expect(response[33m.[39mbody[33m.[39mdata)[33m.[39mtoMatchObject({
     [90m 108 |[39m         id[33m:[39m createdReportId[33m,[39m[0m

      at Object.<anonymous> (test/report-lifecycle.e2e-spec.ts:105:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Report Lifecycle E2E ‚Ä∫ Complete Report Lifecycle ‚Ä∫ 4. Should assign report to team (DEPARTMENT_SUPERVISOR)

    expected 200 "OK", got 400 "Bad Request"

    [0m [90m 115 |[39m         [33m.[39mpatch([32m`/reports/${createdReportId}/assign-team/${testTeamId}`[39m)
     [90m 116 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${authHelper.getSupervisorToken()}`[39m)
    [31m[1m>[22m[39m[90m 117 |[39m         [33m.[39mexpect([35m200[39m)[33m;[39m
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 118 |[39m
     [90m 119 |[39m       expect(response[33m.[39mbody[33m.[39mdata)[33m.[39mtoHaveProperty([32m'assignments'[39m)[33m;[39m
     [90m 120 |[39m       expect(response[33m.[39mbody[33m.[39mdata[33m.[39massignments)[33m.[39mtoEqual([0m

      at Object.<anonymous> (test/report-lifecycle.e2e-spec.ts:117:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Report Lifecycle E2E ‚Ä∫ Complete Report Lifecycle ‚Ä∫ 5. Should start work on report (TEAM_MEMBER)

    expected 200 "OK", got 400 "Bad Request"

    [0m [90m 139 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${authHelper.getTeamMemberToken()}`[39m)
     [90m 140 |[39m         [33m.[39msend(updateStatusDto)
    [31m[1m>[22m[39m[90m 141 |[39m         [33m.[39mexpect([35m200[39m)[33m;[39m
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 142 |[39m
     [90m 143 |[39m       expect(response[33m.[39mbody[33m.[39mdata)[33m.[39mtoMatchObject({
     [90m 144 |[39m         id[33m:[39m createdReportId[33m,[39m[0m

      at Object.<anonymous> (test/report-lifecycle.e2e-spec.ts:141:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Report Lifecycle E2E ‚Ä∫ Complete Report Lifecycle ‚Ä∫ 6. Should complete work and mark as pending approval (TEAM_MEMBER)

    expected 200 "OK", got 400 "Bad Request"

    [0m [90m 158 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${authHelper.getTeamMemberToken()}`[39m)
     [90m 159 |[39m         [33m.[39msend(updateStatusDto)
    [31m[1m>[22m[39m[90m 160 |[39m         [33m.[39mexpect([35m200[39m)[33m;[39m
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 161 |[39m
     [90m 162 |[39m       expect(response[33m.[39mbody[33m.[39mdata)[33m.[39mtoMatchObject({
     [90m 163 |[39m         id[33m:[39m createdReportId[33m,[39m[0m

      at Object.<anonymous> (test/report-lifecycle.e2e-spec.ts:160:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Report Lifecycle E2E ‚Ä∫ Complete Report Lifecycle ‚Ä∫ 7. Should approve completed work (DEPARTMENT_SUPERVISOR)

    expected 200 "OK", got 400 "Bad Request"

    [0m [90m 177 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${authHelper.getSupervisorToken()}`[39m)
     [90m 178 |[39m         [33m.[39msend(updateStatusDto)
    [31m[1m>[22m[39m[90m 179 |[39m         [33m.[39mexpect([35m200[39m)[33m;[39m
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 180 |[39m
     [90m 181 |[39m       expect(response[33m.[39mbody[33m.[39mdata)[33m.[39mtoMatchObject({
     [90m 182 |[39m         id[33m:[39m createdReportId[33m,[39m[0m

      at Object.<anonymous> (test/report-lifecycle.e2e-spec.ts:179:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Report Lifecycle E2E ‚Ä∫ Complete Report Lifecycle ‚Ä∫ 8. Should get status history for the report

    expected 200 "OK", got 400 "Bad Request"

    [0m [90m 191 |[39m         [33m.[39m[36mget[39m([32m`/reports/${createdReportId}/status-history`[39m)
     [90m 192 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${authHelper.getSupervisorToken()}`[39m)
    [31m[1m>[22m[39m[90m 193 |[39m         [33m.[39mexpect([35m200[39m)[33m;[39m
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 194 |[39m
     [90m 195 |[39m       expect([33mArray[39m[33m.[39misArray(response[33m.[39mbody[33m.[39mdata))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 196 |[39m       expect(response[33m.[39mbody[33m.[39mdata[33m.[39mlength)[33m.[39mtoBeGreaterThan([35m0[39m)[33m;[39m[0m

      at Object.<anonymous> (test/report-lifecycle.e2e-spec.ts:193:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Report Lifecycle E2E ‚Ä∫ Validation Tests ‚Ä∫ Should reject assignment to non-existent team

    expected 404 "Not Found", got 400 "Bad Request"

    [0m [90m 279 |[39m         [33m.[39mpatch([32m`/reports/${createdReportId}/assign-team/${nonExistentTeamId}`[39m)
     [90m 280 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${authHelper.getSupervisorToken()}`[39m)
    [31m[1m>[22m[39m[90m 281 |[39m         [33m.[39mexpect([35m404[39m)[33m;[39m
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 282 |[39m     })[33m;[39m
     [90m 283 |[39m   })[33m;[39m
     [90m 284 |[39m[0m

      at Object.<anonymous> (test/report-lifecycle.e2e-spec.ts:281:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Report Lifecycle E2E ‚Ä∫ Report Forwarding ‚Ä∫ Should forward report to another department (DEPARTMENT_SUPERVISOR)

    expected 200 "OK", got 400 "Bad Request"

    [0m [90m 294 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${authHelper.getSupervisorToken()}`[39m)
     [90m 295 |[39m         [33m.[39msend(forwardDto)
    [31m[1m>[22m[39m[90m 296 |[39m         [33m.[39mexpect([35m200[39m)[33m;[39m
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 297 |[39m
     [90m 298 |[39m       expect(response[33m.[39mbody[33m.[39mdata[33m.[39mcurrentDepartmentId)[33m.[39mtoBeDefined()[33m;[39m
     [90m 299 |[39m       [90m// Should have updated the department[39m[0m

      at Object.<anonymous> (test/report-lifecycle.e2e-spec.ts:296:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Report Lifecycle E2E ‚Ä∫ Report Forwarding ‚Ä∫ Should get department change history

    expected 200 "OK", got 400 "Bad Request"

    [0m [90m 304 |[39m         [33m.[39m[36mget[39m([32m`/reports/${createdReportId}/history`[39m)
     [90m 305 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${authHelper.getSupervisorToken()}`[39m)
    [31m[1m>[22m[39m[90m 306 |[39m         [33m.[39mexpect([35m200[39m)[33m;[39m
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 307 |[39m
     [90m 308 |[39m       expect([33mArray[39m[33m.[39misArray(response[33m.[39mbody[33m.[39mdata))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 309 |[39m       [36mif[39m (response[33m.[39mbody[33m.[39mdata[33m.[39mlength [33m>[39m [35m0[39m) {[0m

      at Object.<anonymous> (test/report-lifecycle.e2e-spec.ts:306:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Report Lifecycle E2E ‚Ä∫ Query and Filtering ‚Ä∫ Should list reports with pagination and filters

    expected 200 "OK", got 500 "Internal Server Error"

    [0m [90m 320 |[39m         [33m.[39m[36mget[39m([32m'/reports?page=1&limit=10&status=DONE&reportType=POTHOLE'[39m)
     [90m 321 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${authHelper.getSupervisorToken()}`[39m)
    [31m[1m>[22m[39m[90m 322 |[39m         [33m.[39mexpect([35m200[39m)[33m;[39m
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 323 |[39m
     [90m 324 |[39m       expect(response[33m.[39mbody[33m.[39mdata)[33m.[39mtoHaveProperty([32m'data'[39m)[33m;[39m
     [90m 325 |[39m       expect(response[33m.[39mbody[33m.[39mdata)[33m.[39mtoHaveProperty([32m'total'[39m)[33m;[39m[0m

      at Object.<anonymous> (test/report-lifecycle.e2e-spec.ts:322:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Report Lifecycle E2E ‚Ä∫ Query and Filtering ‚Ä∫ Should find nearby reports

    expected 200 "OK", got 500 "Internal Server Error"

    [0m [90m 333 |[39m         [33m.[39m[36mget[39m([32m'/reports/nearby?latitude=41.0&longitude=29.0&radius=1000'[39m)
     [90m 334 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${authHelper.getSupervisorToken()}`[39m)
    [31m[1m>[22m[39m[90m 335 |[39m         [33m.[39mexpect([35m200[39m)[33m;[39m
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 336 |[39m
     [90m 337 |[39m       expect(response[33m.[39mbody[33m.[39mdata)[33m.[39mtoHaveProperty([32m'data'[39m)[33m;[39m
     [90m 338 |[39m       expect([33mArray[39m[33m.[39misArray(response[33m.[39mbody[33m.[39mdata[33m.[39mdata))[33m.[39mtoBe([36mtrue[39m)[33m;[39m[0m

      at Object.<anonymous> (test/report-lifecycle.e2e-spec.ts:335:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Report Lifecycle E2E ‚Ä∫ Query and Filtering ‚Ä∫ Should get user's own reports

    expected 200 "OK", got 500 "Internal Server Error"

    [0m [90m 343 |[39m         [33m.[39m[36mget[39m([32m'/reports/my-reports?page=1&limit=10'[39m)
     [90m 344 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${authHelper.getCitizenToken()}`[39m)
    [31m[1m>[22m[39m[90m 345 |[39m         [33m.[39mexpect([35m200[39m)[33m;[39m
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 346 |[39m
     [90m 347 |[39m       expect(response[33m.[39mbody[33m.[39mdata)[33m.[39mtoHaveProperty([32m'data'[39m)[33m;[39m
     [90m 348 |[39m       expect([33mArray[39m[33m.[39misArray(response[33m.[39mbody[33m.[39mdata[33m.[39mdata))[33m.[39mtoBe([36mtrue[39m)[33m;[39m[0m

      at Object.<anonymous> (test/report-lifecycle.e2e-spec.ts:345:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

[31m[Nest] 21412  - [39m25.05.2025 12:26:14 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 404 Final Response Payload: {"statusCode":404,"message":"Cannot POST /teams/6/members","error":"NotFoundException","timestamp":"2025-05-25T09:26:14.458Z","path":"/teams/6/members"} Path: /teams/6/members Method: POST[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:14 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mNotFoundException: Cannot POST /teams/6/members
    at callback (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\routes-resolver.js:77:19)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-proxy.js:9:23
    at Layer.handleRequest (C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\lib\layer.js:145:17)
    at trimPrefix (C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\index.js:336:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\index.js:294:9
    at processParams (C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\index.js:574:12)
    at next (C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\index.js:288:5)
    at urlencodedParser (C:\Users\furka\KentNabiz\node_modules\.pnpm\body-parser@2.1.0\node_modules\body-parser\lib\types\urlencoded.js:77:7)
    at Layer.handleRequest (C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\lib\layer.js:145:17)
    at trimPrefix (C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\index.js:336:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\index.js:294:9
    at processParams (C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\index.js:574:12)
    at next (C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\index.js:288:5)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\body-parser@2.1.0\node_modules\body-parser\lib\read.js:132:5
    at AsyncResource.runInAsyncScope (node:async_hooks:211:14)
    at invokeCallback (C:\Users\furka\KentNabiz\node_modules\.pnpm\raw-body@3.0.0\node_modules\raw-body\index.js:238:16)
    at done (C:\Users\furka\KentNabiz\node_modules\.pnpm\raw-body@3.0.0\node_modules\raw-body\index.js:227:7)
    at IncomingMessage.onEnd (C:\Users\furka\KentNabiz\node_modules\.pnpm\raw-body@3.0.0\node_modules\raw-body\index.js:287:7)
    at IncomingMessage.emit (node:events:518:28)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at processTicksAndRejections (node:internal/process/task_queues:90:21)[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:14 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 404 Final Response Payload: {"statusCode":404,"message":"Cannot PATCH /teams/6/members/3","error":"NotFoundException","timestamp":"2025-05-25T09:26:14.501Z","path":"/teams/6/members/3"} Path: /teams/6/members/3 Method: PATCH[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:14 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mNotFoundException: Cannot PATCH /teams/6/members/3
    at callback (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\routes-resolver.js:77:19)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-proxy.js:9:23
    at Layer.handleRequest (C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\lib\layer.js:145:17)
    at trimPrefix (C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\index.js:336:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\index.js:294:9
    at processParams (C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\index.js:574:12)
    at next (C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\index.js:288:5)
    at urlencodedParser (C:\Users\furka\KentNabiz\node_modules\.pnpm\body-parser@2.1.0\node_modules\body-parser\lib\types\urlencoded.js:77:7)
    at Layer.handleRequest (C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\lib\layer.js:145:17)
    at trimPrefix (C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\index.js:336:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\index.js:294:9
    at processParams (C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\index.js:574:12)
    at next (C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\index.js:288:5)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\body-parser@2.1.0\node_modules\body-parser\lib\read.js:132:5
    at AsyncResource.runInAsyncScope (node:async_hooks:211:14)
    at invokeCallback (C:\Users\furka\KentNabiz\node_modules\.pnpm\raw-body@3.0.0\node_modules\raw-body\index.js:238:16)
    at done (C:\Users\furka\KentNabiz\node_modules\.pnpm\raw-body@3.0.0\node_modules\raw-body\index.js:227:7)
    at IncomingMessage.onEnd (C:\Users\furka\KentNabiz\node_modules\.pnpm\raw-body@3.0.0\node_modules\raw-body\index.js:287:7)
    at IncomingMessage.emit (node:events:518:28)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at processTicksAndRejections (node:internal/process/task_queues:90:21)[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:14 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 400 Final Response Payload: {"statusCode":400,"message":"User is not a member of this team.","error":"BadRequestException","timestamp":"2025-05-25T09:26:14.530Z","path":"/teams/6/members/3"} Path: /teams/6/members/3 Method: DELETE[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:14 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mBadRequestException: User is not a member of this team.
    at TeamsService.removeMemberFromTeam (C:\Users\furka\KentNabiz\apps\api\src\modules\teams\services\teams.service.ts:306:13)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:14 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 403 Final Response Payload: {"statusCode":403,"message":"Insufficient permissions.","error":"ForbiddenException","timestamp":"2025-05-25T09:26:14.554Z","path":"/teams"} Path: /teams Method: POST[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:14 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mForbiddenException: Insufficient permissions.
    at RolesGuard.canActivate (C:\Users\furka\KentNabiz\apps\api\src\modules\auth\guards\roles.guard.ts:41:13)
    at GuardsConsumer.tryActivate (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\guards\guards-consumer.js:15:34)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at canActivateFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:135:33)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:42:31
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-proxy.js:9:17[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:14 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 401 Final Response Payload: {"statusCode":401,"message":"Unauthorized","error":"UnauthorizedException","timestamp":"2025-05-25T09:26:14.588Z","path":"/teams/6"} Path: /teams/6 Method: GET[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:14 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mUnauthorizedException: Unauthorized
    at JwtAuthGuard.handleRequest (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:60:30)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:44:124
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:83:24
    at allFailed (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport@0.7.0\node_modules\passport\lib\middleware\authenticate.js:110:18)
    at attempt (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport@0.7.0\node_modules\passport\lib\middleware\authenticate.js:183:28)
    at JwtStrategy.strategy.fail (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport@0.7.0\node_modules\passport\lib\middleware\authenticate.js:314:9)
    at JwtStrategy.Object.<anonymous>.JwtStrategy.authenticate (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport-jwt@4.0.1\node_modules\passport-jwt\lib\strategy.js:96:21)
    at attempt (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport@0.7.0\node_modules\passport\lib\middleware\authenticate.js:378:16)
    at authenticate (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport@0.7.0\node_modules\passport\lib\middleware\authenticate.js:379:7)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:88:3
    at new Promise (<anonymous>)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:80:83
    at JwtAuthGuard.canActivate (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:44:32)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:14 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 404 Final Response Payload: {"statusCode":404,"message":"Cannot PATCH /teams/6/location","error":"NotFoundException","timestamp":"2025-05-25T09:26:14.601Z","path":"/teams/6/location"} Path: /teams/6/location Method: PATCH[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:14 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mNotFoundException: Cannot PATCH /teams/6/location
    at callback (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\routes-resolver.js:77:19)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-proxy.js:9:23
    at Layer.handleRequest (C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\lib\layer.js:145:17)
    at trimPrefix (C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\index.js:336:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\index.js:294:9
    at processParams (C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\index.js:574:12)
    at next (C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\index.js:288:5)
    at urlencodedParser (C:\Users\furka\KentNabiz\node_modules\.pnpm\body-parser@2.1.0\node_modules\body-parser\lib\types\urlencoded.js:77:7)
    at Layer.handleRequest (C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\lib\layer.js:145:17)
    at trimPrefix (C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\index.js:336:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\index.js:294:9
    at processParams (C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\index.js:574:12)
    at next (C:\Users\furka\KentNabiz\node_modules\.pnpm\router@2.1.0\node_modules\router\index.js:288:5)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\body-parser@2.1.0\node_modules\body-parser\lib\read.js:132:5
    at AsyncResource.runInAsyncScope (node:async_hooks:211:14)
    at invokeCallback (C:\Users\furka\KentNabiz\node_modules\.pnpm\raw-body@3.0.0\node_modules\raw-body\index.js:238:16)
    at done (C:\Users\furka\KentNabiz\node_modules\.pnpm\raw-body@3.0.0\node_modules\raw-body\index.js:227:7)
    at IncomingMessage.onEnd (C:\Users\furka\KentNabiz\node_modules\.pnpm\raw-body@3.0.0\node_modules\raw-body\index.js:287:7)
    at IncomingMessage.emit (node:events:518:28)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at processTicksAndRejections (node:internal/process/task_queues:90:21)[39m
HttpExceptionFilter
FAIL test/teams-workflow.e2e-spec.ts
  ‚óè Console

    console.log
      üß™ Setting up E2E test environment...

      at Object.<anonymous> (test/setup-e2e.ts:13:11)

    console.log
      ‚úÖ Test data seeded successfully

      at seedTestData (test/setup-e2e.ts:165:11)

    console.log
      üßπ E2E test environment cleaned up

      at Object.<anonymous> (test/setup-e2e.ts:25:11)

  ‚óè Teams Workflow (E2E) ‚Ä∫ Team Member Management ‚Ä∫ should add member to team (DEPARTMENT_SUPERVISOR)

    expected 201 "Created", got 404 "Not Found"

    [0m [90m 121 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${departmentSupervisorToken}`[39m)
     [90m 122 |[39m         [33m.[39msend(addMemberDto)
    [31m[1m>[22m[39m[90m 123 |[39m         [33m.[39mexpect([35m201[39m)[33m;[39m
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 124 |[39m
     [90m 125 |[39m       expect(response[33m.[39mbody[33m.[39mdata)[33m.[39mtoMatchObject({
     [90m 126 |[39m         teamId[33m:[39m createdTeamId[33m,[39m[0m

      at Object.<anonymous> (test/teams-workflow.e2e-spec.ts:123:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Teams Workflow (E2E) ‚Ä∫ Team Member Management ‚Ä∫ should get team members

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

    [0m [90m 137 |[39m
     [90m 138 |[39m       expect([33mArray[39m[33m.[39misArray(response[33m.[39mbody[33m.[39mdata))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 139 |[39m       expect(response[33m.[39mbody[33m.[39mdata[33m.[39mlength)[33m.[39mtoBeGreaterThan([35m0[39m)[33m;[39m
     [90m     |[39m                                         [31m[1m^[22m[39m
     [90m 140 |[39m     })[33m;[39m
     [90m 141 |[39m
     [90m 142 |[39m     it([32m'should update member specializations'[39m[33m,[39m [36masync[39m () [33m=>[39m {[0m

      at Object.<anonymous> (test/teams-workflow.e2e-spec.ts:139:41)

  ‚óè Teams Workflow (E2E) ‚Ä∫ Team Member Management ‚Ä∫ should update member specializations

    expected 200 "OK", got 404 "Not Found"

    [0m [90m 149 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${departmentSupervisorToken}`[39m)
     [90m 150 |[39m         [33m.[39msend(updateMemberDto)
    [31m[1m>[22m[39m[90m 151 |[39m         [33m.[39mexpect([35m200[39m)[33m;[39m
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 152 |[39m
     [90m 153 |[39m       expect(response[33m.[39mbody[33m.[39mdata[33m.[39mspecializations)[33m.[39mtoEqual([[32m'ELECTRICAL'[39m[33m,[39m [32m'CARPENTRY'[39m])[33m;[39m
     [90m 154 |[39m     })[33m;[39m[0m

      at Object.<anonymous> (test/teams-workflow.e2e-spec.ts:151:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Teams Workflow (E2E) ‚Ä∫ Team Member Management ‚Ä∫ should remove member from team (DEPARTMENT_SUPERVISOR)

    expected 200 "OK", got 400 "Bad Request"

    [0m [90m 158 |[39m         [33m.[39m[36mdelete[39m([32m`/teams/${createdTeamId}/members/3`[39m)
     [90m 159 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${departmentSupervisorToken}`[39m)
    [31m[1m>[22m[39m[90m 160 |[39m         [33m.[39mexpect([35m200[39m)[33m;[39m
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 161 |[39m     })[33m;[39m
     [90m 162 |[39m   })[33m;[39m
     [90m 163 |[39m[0m

      at Object.<anonymous> (test/teams-workflow.e2e-spec.ts:160:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Teams Workflow (E2E) ‚Ä∫ Team Location Management ‚Ä∫ should update team location

    expected 200 "OK", got 404 "Not Found"

    [0m [90m 208 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${departmentSupervisorToken}`[39m)
     [90m 209 |[39m         [33m.[39msend(updateLocationDto)
    [31m[1m>[22m[39m[90m 210 |[39m         [33m.[39mexpect([35m200[39m)[33m;[39m
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 211 |[39m
     [90m 212 |[39m       expect(response[33m.[39mbody[33m.[39mdata[33m.[39mcurrentLocation)[33m.[39mtoMatchObject({
     [90m 213 |[39m         type[33m:[39m [32m'Point'[39m[33m,[39m[0m

      at Object.<anonymous> (test/teams-workflow.e2e-spec.ts:210:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Teams Workflow (E2E) ‚Ä∫ Team Cleanup ‚Ä∫ should delete team (SYSTEM_ADMIN)

    expected 200 "OK", got 204 "No Content"

    [0m [90m 231 |[39m         [33m.[39m[36mdelete[39m([32m`/teams/${createdTeamId}`[39m)
     [90m 232 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${systemAdminToken}`[39m)
    [31m[1m>[22m[39m[90m 233 |[39m         [33m.[39mexpect([35m200[39m)[33m;[39m
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 234 |[39m     })[33m;[39m
     [90m 235 |[39m
     [90m 236 |[39m     it([32m'should confirm team is deleted'[39m[33m,[39m [36masync[39m () [33m=>[39m {[0m

      at Object.<anonymous> (test/teams-workflow.e2e-spec.ts:233:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Teams Workflow (E2E) ‚Ä∫ Team Cleanup ‚Ä∫ should confirm team is deleted

    expected 404 "Not Found", got 200 "OK"

    [0m [90m 238 |[39m         [33m.[39m[36mget[39m([32m`/teams/${createdTeamId}`[39m)
     [90m 239 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${departmentSupervisorToken}`[39m)
    [31m[1m>[22m[39m[90m 240 |[39m         [33m.[39mexpect([35m404[39m)[33m;[39m
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 241 |[39m     })[33m;[39m
     [90m 242 |[39m   })[33m;[39m
     [90m 243 |[39m })[33m;[39m[0m

      at Object.<anonymous> (test/teams-workflow.e2e-spec.ts:240:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

[31m[Nest] 21412  - [39m25.05.2025 12:26:17 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 500 Final Response Payload: {"statusCode":500,"message":"Internal server error","error":"TransactionNotStartedError","timestamp":"2025-05-25T09:26:17.460Z","path":"/reports"} Path: /reports Method: POST[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:17 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mTransactionNotStartedError: Transaction is not started yet, start transaction before committing or rolling it back.
    at PostgresQueryRunner.rollbackTransaction (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\driver\postgres\PostgresQueryRunner.ts:220:46)
    at ReportRepository.create (C:\Users\furka\KentNabiz\apps\api\src\modules\reports\repositories\report.repository.ts:228:25)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at ReportsService.create (C:\Users\furka\KentNabiz\apps\api\src\modules\reports\services\reports.service.ts:258:29)[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:17 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 500 Final Response Payload: {"statusCode":500,"message":"Internal server error","error":"QueryFailedError","timestamp":"2025-05-25T09:26:17.547Z","path":"/reports?page=1&limit=10&status=OPEN&reportType=POTHOLE"} Path: /reports?page=1&limit=10&status=OPEN&reportType=POTHOLE Method: GET[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:17 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mQueryFailedError: column assignments.accepted_at does not exist
    at PostgresQueryRunner.query (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\driver\postgres\PostgresQueryRunner.ts:331:19)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at SelectQueryBuilder.loadRawResults (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\query-builder\SelectQueryBuilder.ts:3805:25)
    at SelectQueryBuilder.getRawMany (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\query-builder\SelectQueryBuilder.ts:1626:29)
    at SelectQueryBuilder.executeEntitiesAndRawResults (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\query-builder\SelectQueryBuilder.ts:3467:26)
    at SelectQueryBuilder.getManyAndCount (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\query-builder\SelectQueryBuilder.ts:1873:36)
    at ReportRepository.findAll (C:\Users\furka\KentNabiz\apps\api\src\modules\reports\repositories\report.repository.ts:80:30)[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:17 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 400 Final Response Payload: {"statusCode":400,"message":"Validation failed (numeric string is expected)","error":"BadRequestException","timestamp":"2025-05-25T09:26:17.608Z","path":"/reports/undefined/forward"} Path: /reports/undefined/forward Method: PATCH[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:17 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mBadRequestException: Validation failed (numeric string is expected)
    at ParseIntPipe.exceptionFactory (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:24:27)
    at ParseIntPipe.transform (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:38:24)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\pipes\pipes-consumer.js:16:33
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at resolveParamValue (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:148:23)
    at async Promise.all (index 2)
    at pipesFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:151:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:37:30[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:17 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 400 Final Response Payload: {"statusCode":400,"message":"Validation failed (numeric string is expected)","error":"BadRequestException","timestamp":"2025-05-25T09:26:17.625Z","path":"/reports/undefined/history"} Path: /reports/undefined/history Method: GET[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:17 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mBadRequestException: Validation failed (numeric string is expected)
    at ParseIntPipe.exceptionFactory (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:24:27)
    at ParseIntPipe.transform (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:38:24)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\pipes\pipes-consumer.js:16:33
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at resolveParamValue (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:148:23)
    at async Promise.all (index 1)
    at pipesFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:151:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:37:30[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:17 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 500 Final Response Payload: {"statusCode":500,"message":"Internal server error","error":"QueryFailedError","timestamp":"2025-05-25T09:26:17.651Z","path":"/reports/nearby?latitude=29.0&longitude=41.0&radius=1000"} Path: /reports/nearby?latitude=29.0&longitude=41.0&radius=1000 Method: GET[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:17 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mQueryFailedError: column assignments.accepted_at does not exist
    at PostgresQueryRunner.query (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\driver\postgres\PostgresQueryRunner.ts:331:19)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at SelectQueryBuilder.loadRawResults (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\query-builder\SelectQueryBuilder.ts:3805:25)
    at SelectQueryBuilder.getRawMany (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\query-builder\SelectQueryBuilder.ts:1626:29)
    at SelectQueryBuilder.executeEntitiesAndRawResults (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\query-builder\SelectQueryBuilder.ts:3467:26)
    at SelectQueryBuilder.getManyAndCount (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\query-builder\SelectQueryBuilder.ts:1873:36)
    at ReportRepository.findNearby (C:\Users\furka\KentNabiz\apps\api\src\modules\reports\repositories\report.repository.ts:168:30)[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:17 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 500 Final Response Payload: {"statusCode":500,"message":"Internal server error","error":"QueryFailedError","timestamp":"2025-05-25T09:26:17.676Z","path":"/reports/999999"} Path: /reports/999999 Method: GET[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:17 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mQueryFailedError: column Report__Report_assignments.accepted_at does not exist
    at PostgresQueryRunner.query (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\driver\postgres\PostgresQueryRunner.ts:331:19)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at SelectQueryBuilder.loadRawResults (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\query-builder\SelectQueryBuilder.ts:3805:25)
    at SelectQueryBuilder.getRawMany (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\query-builder\SelectQueryBuilder.ts:1626:29)
    at SelectQueryBuilder.executeEntitiesAndRawResults (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\query-builder\SelectQueryBuilder.ts:3467:26)
    at SelectQueryBuilder.getRawAndEntities (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\query-builder\SelectQueryBuilder.ts:1670:29)
    at SelectQueryBuilder.getOne (C:\Users\furka\KentNabiz\node_modules\.pnpm\typeorm@0.3.21_ioredis@5.6._e3b7d879b4c41320d7a731c639c18759\src\query-builder\SelectQueryBuilder.ts:1697:25)
    at ReportsService.findOne (C:\Users\furka\KentNabiz\apps\api\src\modules\reports\services\reports.service.ts:204:20)[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:17 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 401 Final Response Payload: {"statusCode":401,"message":"Unauthorized","error":"UnauthorizedException","timestamp":"2025-05-25T09:26:17.692Z","path":"/reports"} Path: /reports Method: POST[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:17 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mUnauthorizedException: Unauthorized
    at JwtAuthGuard.handleRequest (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:60:30)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:44:124
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:83:24
    at allFailed (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport@0.7.0\node_modules\passport\lib\middleware\authenticate.js:110:18)
    at attempt (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport@0.7.0\node_modules\passport\lib\middleware\authenticate.js:183:28)
    at JwtStrategy.strategy.fail (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport@0.7.0\node_modules\passport\lib\middleware\authenticate.js:314:9)
    at JwtStrategy.Object.<anonymous>.JwtStrategy.authenticate (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport-jwt@4.0.1\node_modules\passport-jwt\lib\strategy.js:96:21)
    at attempt (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport@0.7.0\node_modules\passport\lib\middleware\authenticate.js:378:16)
    at authenticate (C:\Users\furka\KentNabiz\node_modules\.pnpm\passport@0.7.0\node_modules\passport\lib\middleware\authenticate.js:379:7)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:88:3
    at new Promise (<anonymous>)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:80:83
    at JwtAuthGuard.canActivate (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+passport@11.0.5_@ne_33170d5ddf27925c71f4bc267b90bbe1\node_modules\@nestjs\passport\dist\auth.guard.js:44:32)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
HttpExceptionFilter
[31m[Nest] 21412  - [39m25.05.2025 12:26:17 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mHTTP Status: 400 Final Response Payload: {"statusCode":400,"message":"Validation failed (numeric string is expected)","error":"BadRequestException","timestamp":"2025-05-25T09:26:17.714Z","path":"/reports/undefined"} Path: /reports/undefined Method: GET[39m
[31m[Nest] 21412  - [39m25.05.2025 12:26:17 [31m  ERROR[39m [38;5;3m[HttpExceptionFilter] [39m[31mBadRequestException: Validation failed (numeric string is expected)
    at ParseIntPipe.exceptionFactory (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:24:27)
    at ParseIntPipe.transform (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+common@11.0.12_clas_a2af2bac15e3834d3db5565fc45d57a7\node_modules\@nestjs\common\pipes\parse-int.pipe.js:38:24)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\pipes\pipes-consumer.js:16:33
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at resolveParamValue (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:148:23)
    at async Promise.all (index 1)
    at pipesFn (C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:151:13)
    at C:\Users\furka\KentNabiz\node_modules\.pnpm\@nestjs+core@11.0.12_@nestj_b33b5792bd9420a7838e1168c93cfe11\node_modules\@nestjs\core\router\router-execution-context.js:37:30[39m
HttpExceptionFilter
FAIL test/reports-workflow.e2e-spec.ts
  ‚óè Console

    console.log
      üß™ Setting up E2E test environment...

      at Object.<anonymous> (test/setup-e2e.ts:13:11)

    console.log
      ‚úÖ Test data seeded successfully

      at seedTestData (test/setup-e2e.ts:165:11)

    console.log
      [findOne] AuthUser: {"sub":1,"email":"citizen@test.com","roles":["CITIZEN"],"departmentId":null,"jti":"test-1-1748165177660"}

      at ReportsService.findOne (src/modules/reports/services/reports.service.ts:203:13)

    console.log
      üßπ E2E test environment cleaned up

      at Object.<anonymous> (test/setup-e2e.ts:25:11)

  ‚óè Reports Workflow (E2E) ‚Ä∫ Report Creation ‚Ä∫ should create a new report (CITIZEN)

    expected 201 "Created", got 500 "Internal Server Error"

    [0m [90m 56 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${authHelper.getCitizenToken()}`[39m)
     [90m 57 |[39m         [33m.[39msend(createReportDto)
    [31m[1m>[22m[39m[90m 58 |[39m         [33m.[39mexpect([35m201[39m)[33m;[39m
     [90m    |[39m          [31m[1m^[22m[39m
     [90m 59 |[39m
     [90m 60 |[39m       expect(response[33m.[39mbody[33m.[39mdata)[33m.[39mtoMatchObject({
     [90m 61 |[39m         title[33m:[39m [32m'Pothole on Main Street'[39m[33m,[39m[0m

      at Object.<anonymous> (test/reports-workflow.e2e-spec.ts:58:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Reports Workflow (E2E) ‚Ä∫ Report Creation ‚Ä∫ should get report by id

    expect(received).toBeDefined()

    Received: undefined

    [0m [90m 71 |[39m
     [90m 72 |[39m     it([32m'should get report by id'[39m[33m,[39m [36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 73 |[39m       expect(createdReportId)[33m.[39mtoBeDefined()[33m;[39m
     [90m    |[39m                               [31m[1m^[22m[39m
     [90m 74 |[39m       expect([36mtypeof[39m createdReportId)[33m.[39mtoBe([32m'number'[39m)[33m;[39m
     [90m 75 |[39m
     [90m 76 |[39m       [36mconst[39m response [33m=[39m [36mawait[39m request(app[33m.[39mgetHttpServer())[0m

      at Object.<anonymous> (test/reports-workflow.e2e-spec.ts:73:31)

  ‚óè Reports Workflow (E2E) ‚Ä∫ Report Creation ‚Ä∫ should list reports with filters and pagination

    expected 200 "OK", got 500 "Internal Server Error"

    [0m [90m 90 |[39m         [33m.[39m[36mget[39m([32m'/reports?page=1&limit=10&status=OPEN&reportType=POTHOLE'[39m)
     [90m 91 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${authHelper.getSupervisorToken()}`[39m)
    [31m[1m>[22m[39m[90m 92 |[39m         [33m.[39mexpect([35m200[39m)[33m;[39m
     [90m    |[39m          [31m[1m^[22m[39m
     [90m 93 |[39m
     [90m 94 |[39m       expect(response[33m.[39mbody)[33m.[39mtoHaveProperty([32m'data'[39m)[33m;[39m
     [90m 95 |[39m       expect(response[33m.[39mbody)[33m.[39mtoHaveProperty([32m'total'[39m)[33m;[39m[0m

      at Object.<anonymous> (test/reports-workflow.e2e-spec.ts:92:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Reports Workflow (E2E) ‚Ä∫ Report Assignment ‚Ä∫ should assign report to team (DEPARTMENT_SUPERVISOR)

    expect(received).toBeDefined()

    Received: undefined

    [0m [90m 102 |[39m   describe([32m'Report Assignment'[39m[33m,[39m () [33m=>[39m {
     [90m 103 |[39m     it([32m'should assign report to team (DEPARTMENT_SUPERVISOR)'[39m[33m,[39m [36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 104 |[39m       expect(createdReportId)[33m.[39mtoBeDefined()[33m;[39m
     [90m     |[39m                               [31m[1m^[22m[39m
     [90m 105 |[39m       expect([36mtypeof[39m createdReportId)[33m.[39mtoBe([32m'number'[39m)[33m;[39m
     [90m 106 |[39m
     [90m 107 |[39m       [36mconst[39m assignToTeamDto [33m=[39m {[0m

      at Object.<anonymous> (test/reports-workflow.e2e-spec.ts:104:31)

  ‚óè Reports Workflow (E2E) ‚Ä∫ Report Assignment ‚Ä∫ should assign report to user (DEPARTMENT_SUPERVISOR)

    expect(received).toBeDefined()

    Received: undefined

    [0m [90m 127 |[39m
     [90m 128 |[39m     it([32m'should assign report to user (DEPARTMENT_SUPERVISOR)'[39m[33m,[39m [36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 129 |[39m       expect(createdReportId)[33m.[39mtoBeDefined()[33m;[39m
     [90m     |[39m                               [31m[1m^[22m[39m
     [90m 130 |[39m       expect([36mtypeof[39m createdReportId)[33m.[39mtoBe([32m'number'[39m)[33m;[39m
     [90m 131 |[39m
     [90m 132 |[39m       [36mconst[39m response [33m=[39m [36mawait[39m request(app[33m.[39mgetHttpServer())[0m

      at Object.<anonymous> (test/reports-workflow.e2e-spec.ts:129:31)

  ‚óè Reports Workflow (E2E) ‚Ä∫ Report Assignment ‚Ä∫ should deny assignment by unauthorized user

    expect(received).toBeDefined()

    Received: undefined

    [0m [90m 148 |[39m
     [90m 149 |[39m     it([32m'should deny assignment by unauthorized user'[39m[33m,[39m [36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 150 |[39m       expect(createdReportId)[33m.[39mtoBeDefined()[33m;[39m
     [90m     |[39m                               [31m[1m^[22m[39m
     [90m 151 |[39m       expect([36mtypeof[39m createdReportId)[33m.[39mtoBe([32m'number'[39m)[33m;[39m
     [90m 152 |[39m
     [90m 153 |[39m       [36mawait[39m request(app[33m.[39mgetHttpServer())[0m

      at Object.<anonymous> (test/reports-workflow.e2e-spec.ts:150:31)

  ‚óè Reports Workflow (E2E) ‚Ä∫ Report Status Management ‚Ä∫ should update report status (TEAM_MEMBER)

    expect(received).toBeDefined()

    Received: undefined

    [0m [90m 160 |[39m   describe([32m'Report Status Management'[39m[33m,[39m () [33m=>[39m {
     [90m 161 |[39m     it([32m'should update report status (TEAM_MEMBER)'[39m[33m,[39m [36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 162 |[39m       expect(createdReportId)[33m.[39mtoBeDefined()[33m;[39m
     [90m     |[39m                               [31m[1m^[22m[39m
     [90m 163 |[39m       expect([36mtypeof[39m createdReportId)[33m.[39mtoBe([32m'number'[39m)[33m;[39m
     [90m 164 |[39m
     [90m 165 |[39m       [36mconst[39m updateStatusDto [33m=[39m {[0m

      at Object.<anonymous> (test/reports-workflow.e2e-spec.ts:162:31)

  ‚óè Reports Workflow (E2E) ‚Ä∫ Report Status Management ‚Ä∫ should update report status with sub-status

    expect(received).toBeDefined()

    Received: undefined

    [0m [90m 181 |[39m
     [90m 182 |[39m     it([32m'should update report status with sub-status'[39m[33m,[39m [36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 183 |[39m       expect(createdReportId)[33m.[39mtoBeDefined()[33m;[39m
     [90m     |[39m                               [31m[1m^[22m[39m
     [90m 184 |[39m       expect([36mtypeof[39m createdReportId)[33m.[39mtoBe([32m'number'[39m)[33m;[39m
     [90m 185 |[39m
     [90m 186 |[39m       [36mconst[39m updateStatusDto [33m=[39m {[0m

      at Object.<anonymous> (test/reports-workflow.e2e-spec.ts:183:31)

  ‚óè Reports Workflow (E2E) ‚Ä∫ Report Status Management ‚Ä∫ should get report status history

    expect(received).toBeDefined()

    Received: undefined

    [0m [90m 204 |[39m
     [90m 205 |[39m     it([32m'should get report status history'[39m[33m,[39m [36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 206 |[39m       expect(createdReportId)[33m.[39mtoBeDefined()[33m;[39m
     [90m     |[39m                               [31m[1m^[22m[39m
     [90m 207 |[39m       expect([36mtypeof[39m createdReportId)[33m.[39mtoBe([32m'number'[39m)[33m;[39m
     [90m 208 |[39m
     [90m 209 |[39m       [36mconst[39m response [33m=[39m [36mawait[39m request(app[33m.[39mgetHttpServer())[0m

      at Object.<anonymous> (test/reports-workflow.e2e-spec.ts:206:31)

  ‚óè Reports Workflow (E2E) ‚Ä∫ Report Forwarding ‚Ä∫ should forward report to different department (DEPARTMENT_SUPERVISOR)

    expected 200 "OK", got 400 "Bad Request"

    [0m [90m 231 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${authHelper.getSupervisorToken()}`[39m)
     [90m 232 |[39m         [33m.[39msend(forwardReportDto)
    [31m[1m>[22m[39m[90m 233 |[39m         [33m.[39mexpect([35m200[39m)[33m;[39m
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 234 |[39m
     [90m 235 |[39m       expect(response[33m.[39mbody[33m.[39mdata)[33m.[39mtoHaveProperty([32m'currentDepartmentId'[39m)[33m;[39m
     [90m 236 |[39m       expect(response[33m.[39mbody[33m.[39mdata[33m.[39msubStatus)[33m.[39mtoBe([32m'FORWARDED'[39m)[33m;[39m[0m

      at Object.<anonymous> (test/reports-workflow.e2e-spec.ts:233:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Reports Workflow (E2E) ‚Ä∫ Report Forwarding ‚Ä∫ should get department history

    expected 200 "OK", got 400 "Bad Request"

    [0m [90m 241 |[39m         [33m.[39m[36mget[39m([32m`/reports/${createdReportId}/history`[39m)
     [90m 242 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${authHelper.getSystemAdminToken()}`[39m)
    [31m[1m>[22m[39m[90m 243 |[39m         [33m.[39mexpect([35m200[39m)[33m;[39m
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 244 |[39m
     [90m 245 |[39m       expect([33mArray[39m[33m.[39misArray(response[33m.[39mbody[33m.[39mdata))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 246 |[39m       expect(response[33m.[39mbody[33m.[39mdata[33m.[39mlength)[33m.[39mtoBeGreaterThan([35m0[39m)[33m;[39m[0m

      at Object.<anonymous> (test/reports-workflow.e2e-spec.ts:243:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Reports Workflow (E2E) ‚Ä∫ Report Analytics and Search ‚Ä∫ should search reports by location radius

    expected 200 "OK", got 500 "Internal Server Error"

    [0m [90m 279 |[39m         [33m.[39m[36mget[39m([32m'/reports/nearby?latitude=29.0&longitude=41.0&radius=1000'[39m)
     [90m 280 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${authHelper.getSupervisorToken()}`[39m)
    [31m[1m>[22m[39m[90m 281 |[39m         [33m.[39mexpect([35m200[39m)[33m;[39m
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 282 |[39m
     [90m 283 |[39m       expect(response[33m.[39mbody)[33m.[39mtoHaveProperty([32m'data'[39m)[33m;[39m
     [90m 284 |[39m       expect([33mArray[39m[33m.[39misArray(response[33m.[39mbody[33m.[39mdata))[33m.[39mtoBe([36mtrue[39m)[33m;[39m[0m

      at Object.<anonymous> (test/reports-workflow.e2e-spec.ts:281:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Reports Workflow (E2E) ‚Ä∫ Authorization and Security ‚Ä∫ should allow citizens to only view their own reports

    expected 404 "Not Found", got 500 "Internal Server Error"

    [0m [90m 316 |[39m         [33m.[39m[36mget[39m([32m'/reports/999999'[39m)
     [90m 317 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${authHelper.getCitizenToken()}`[39m)
    [31m[1m>[22m[39m[90m 318 |[39m         [33m.[39mexpect([35m404[39m)[33m;[39m [90m// Should not find or deny access[39m
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 319 |[39m     })[33m;[39m
     [90m 320 |[39m
     [90m 321 |[39m     it([32m'should deny report creation without authentication'[39m[33m,[39m [36masync[39m () [33m=>[39m {[0m

      at Object.<anonymous> (test/reports-workflow.e2e-spec.ts:318:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

  ‚óè Reports Workflow (E2E) ‚Ä∫ Authorization and Security ‚Ä∫ should allow SYSTEM_ADMIN to access all reports

    expected 200 "OK", got 400 "Bad Request"

    [0m [90m 337 |[39m         [33m.[39m[36mget[39m([32m`/reports/${createdReportId}`[39m)
     [90m 338 |[39m         [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${authHelper.getSystemAdminToken()}`[39m)
    [31m[1m>[22m[39m[90m 339 |[39m         [33m.[39mexpect([35m200[39m)[33m;[39m
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 340 |[39m
     [90m 341 |[39m       expect(response[33m.[39mbody[33m.[39mdata[33m.[39mid)[33m.[39mtoBe(createdReportId)[33m;[39m
     [90m 342 |[39m     })[33m;[39m[0m

      at Object.<anonymous> (test/reports-workflow.e2e-spec.ts:339:10)
      ----
      at Test._assertStatus (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:252:14)
      at ../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../../node_modules/.pnpm/supertest@7.0.0/node_modules/supertest/lib/test.js:120:14)

Test Suites: 4 failed, 1 passed, 5 total
Tests:       40 failed, 5 skipped, 51 passed, 96 total
Snapshots:   0 total
Time:        26.797 s
Ran all test suites.
‚ÄâELIFECYCLE‚Äâ Command failed with exit code 1.
